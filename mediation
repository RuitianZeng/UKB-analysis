setwd("D:\\SCI\\UKB\\Artificial sweeteners")
data <- read.csv("as_data_selected.csv")
data2 <- read.csv("D:\\SCI\\UKB\\TyG\\TyG_data.csv")
data3 <- read.csv("D:\\SCI\\UKB\\Artificial sweeteners\\ICD诊断\\E11cox.csv")

data <- merge(data,data2,by="Participant.ID")
data <- merge(data,data3, by = "Participant.ID")
model <- glm(E11_status_cox ~ AS_added+Age.at.recruitment+
              Sex+Ethnicity +Townsend.deprivation.index.at.recruitment+Edu_pro+Smoking.status...Instance.0+Alcohol.drinker.status...Instance.0+
              Physical_activity_per_week+
              Energy_intake+Sugar_intake+Sodium_intake+Red_meat_intake+Processed_meat_intake+Vegetable_intake+Fruit_intake+Vitamin_supplemention+Fiber_intake+
              Monounsaturated_fatty_acids+Saturated_fatty_acids,data=data)

model2 <- survreg(Surv(depressive_episode_time_cox,depressive_episode_status_cox>0) ~ AS_added+E11_status_cox+Age.at.recruitment+
                  Sex+Ethnicity +Townsend.deprivation.index.at.recruitment+Edu_pro+Smoking.status...Instance.0+Alcohol.drinker.status...Instance.0+
                  Physical_activity_per_week+
                  Energy_intake+Sugar_intake+Sodium_intake+Red_meat_intake+Processed_meat_intake+Vegetable_intake+Fruit_intake+Vitamin_supplemention+Fiber_intake+
                  Monounsaturated_fatty_acids+Saturated_fatty_acids,data = data)

library(mediation)
med <- mediate(model,model2,treat = "AS_added",
               mediator = "E11_status_cox",outcome = "depressive_episode_time_cox",robustSE = T,boot = T, sims = 100)
